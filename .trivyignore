# Trivy ignore file for security scanning
# This file contains vulnerabilities that are intentionally ignored

# Development-specific vulnerabilities that don't affect production
CVE-2024-28849  # Development-only dependency issue in @next/eslint-plugin-next

# Node.js vulnerabilities that are handled by environment constraints
# (We enforce Node.js >=20 in package.json)

# Frontend static build vulnerabilities that don't apply to backend API

# Example JWT tokens in API documentation (not real secrets)
# These are truncated example strings like "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
# which only decode to the JWT header and are used for API documentation purposes
# in backend/openapi.json and generated frontend API schema
secret:jwt
secret:generic-api-key

# pnpm path collision vulnerability (CVE-2024-49766)
# This is a theoretical attack that requires specific conditions:
# - Attacker must have write access to the package registry
# - Hash collision must occur for package paths
# - Not exploitable in our controlled environment
# We use pnpm 9.x which has mitigations in place
CVE-2024-49766

# js-yaml schema loading vulnerability
# Our usage of js-yaml is limited to build-time configuration parsing
# with trusted input only (no user-provided YAML)
CVE-2024-56300

# path-to-regexp ReDoS vulnerabilities (CVE-2024-45296, CVE-2024-52798)
# These affect path-to-regexp versions prior to specific patches:
# - CVE-2024-45296: Affects <0.1.10, <1.9.0, <3.3.0, <6.3.0, <8.0.0
# - CVE-2024-52798: Affects <0.1.12
# Our installed versions are patched:
# - path-to-regexp@0.1.12 (patched for CVE-2024-52798)
# - path-to-regexp@3.3.0 (patched for CVE-2024-45296)
# Express 4.21.2 uses the patched 0.1.12 version internally
# Trivy may not recognize these as patched due to database lag
CVE-2024-45296
CVE-2024-52798

# cookie package XSS vulnerability (CVE-2024-47764)
# Affects cookie package <0.7.0
# Our installed version is cookie@1.0.2 which includes the fix
# This is used by cookie-parser and Express
# Trivy may not recognize this as patched due to database lag
CVE-2024-47764

# Express vulnerabilities that are either patched or false positives
# CVE-2024-10491: Express 3.x Link header injection (we use Express 4.21.2)
# This CVE only affects Express 3.x which is EOL
# Scanning tools may incorrectly flag Express 4.x as vulnerable
CVE-2024-10491

# CVE-2024-29041: Express Open Redirect vulnerability
# Fixed in Express 4.19.2+
# Our installed version is Express 4.21.2 which includes the fix
CVE-2024-29041

# React Server Components RCE vulnerabilities (January 2025)
# CVE-2025-55182: React Server Components remote code execution
# CVE-2025-66478: Next.js App Router remote code execution
# Fixed in:
#   - React: 19.0.1, 19.1.2, 19.2.1+
#   - Next.js: 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 15.6.0-canary.58+, 16.0.7+
# Our versions:
#   - React: 19.2.3 (includes fix - patched version)
#   - Next.js: 15.6.0-canary.61 (includes fix - canary.58+ is patched)
# Trivy may not recognize canary versions as patched, but they are safe
CVE-2025-55182
CVE-2025-66478

# Additional React vulnerabilities disclosed with the above (not RCE)
# CVE-2025-55183, CVE-2025-55184: Related vulnerabilities in React
# Fixed in the same React versions as CVE-2025-55182
CVE-2025-55183
CVE-2025-55184

# pnpm vulnerabilities (2024-2025)
# CVE-2024-53866: pnpm workspace cache poisoning leading to arbitrary code execution
# Affects pnpm <9.15.0
# Fix: Upgrade to pnpm >=9.15.0
# CI version has been updated to 9.15.0 (was "9" which could install any 9.x)
# This project also uses separate workspaces as additional mitigation
CVE-2024-53866

# fast-xml-parser DoS vulnerability (2025)
# GHSA-37qj-frw5-hhjh: RangeError DoS Numeric Entities Bug
# Affects: >=4.3.6 <=5.3.3
# Fixed in: >=5.3.4
# Our override ensures: >=5.3.4 (transitive dependency)
GHSA-37qj-frw5-hhjh

# lodash Prototype Pollution (2024)
# GHSA-xxjr-mmjv-4gpg: Prototype Pollution in _.unset and _.omit
# Affects: >=4.0.0 <=4.17.22
# Fixed in: >=4.17.23
# Our override ensures: >=4.17.23 (transitive dependency)
GHSA-xxjr-mmjv-4gpg

# Next.js Image Optimizer DoS (2025)
# GHSA-9g9p-9gw9-jx7f: DoS via Image Optimizer remotePatterns
# Affects: >=15.6.0-canary.0 <16.1.5
# Fixed in: >=16.1.5
# Current version: 15.6.0-canary.61 (vulnerable range)
# Severity: MODERATE (only affects self-hosted with specific remotePatterns config)
# Impact: Low for this project (not using remotePatterns in production)
# Note: Will be resolved when upgrading to Next.js 16.1.5+ or stable 16.x
GHSA-9g9p-9gw9-jx7f